# Use the Dart stable image
FROM dart:stable

# Set the working directory in the container
WORKDIR /app

# Install Dart Frog globally and update the PATH
RUN dart pub global activate dart_frog && \
    export PATH="$PATH:/root/.pub-cache/bin"  # Add the location of global Dart packages to the PATH

# Copy all project files into the container
COPY . .

# Install dependencies
RUN dart pub get

# Build the project for production
RUN /root/.pub-cache/bin/dart_frog build  # Explicitly reference the path to the dart_frog binary

# Expose the default Dart Frog port (8080)
EXPOSE 8080

# Run the server from the router/ directory (adjust this path based on your setup)
CMD ["dart", "run", "router/index.dart"]  # Adjust this path based on your project structure
