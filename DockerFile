# Use the Dart stable image
FROM dart:stable

# Set the working directory in the container
WORKDIR /app

# Install dart_frog globally and update the PATH
RUN dart pub global activate dart_frog
ENV PATH="$PATH:/root/.pub-cache/bin"  

# Copy all project files into the container
COPY . .

# Install dependencies
RUN dart pub get

# Build the project for production
RUN dart_frog build  # This will build the Dart Frog app

# Expose the default Dart Frog port (8080)
EXPOSE 8080

# Run the server from the router/ directory (assuming the entry file is router/index.dart)
CMD ["dart", "run", "router/index.dart"]  # Adjust this path based on your setup
